{% extends 'base.html.twig' %}

{% block title %}My Team{% endblock %}

{% block body %}
    <h1>My Team ({{ pagination.getTotalItemCount }} Employees in total)</h1>
    <a href="{{ path('dashboard_start') }}"><span class="fa fa-arrow-circle-left"></span> Return to dashboard</a><br><br>

    <!-- CYCLES WITH FORMS AVAILABLE YET -->
    <table class="table table-hover">
        <thead>
            <tr>
                <th style="border: 0;"><h2>{{ forms[0].cycle.name }}</h2></th>
            </tr>
            <tr>
                <th style="background-color: #EEEEEE; border: none; width: 200px;">{{ knp_pagination_sortable(pagination, 'Employee', 'user.firstname') }}</th>
                <th style="background-color: #EEEEEE; border: none; width: 200px;">{{ knp_pagination_sortable(pagination, 'Team', 'user.team') }}</th>
                <th colspan="2" style="background-color: #EEEEEE; border: none; border-left: thin; border-left-style: dotted; border-left-color: #FFFFFF;">CDP</th>
                <th colspan="2" style="background-color: #EEEEEE; border: none; border-left: thin; border-left-style: dotted; border-left-color: #FFFFFF;">Year-End</th>
            </tr>
            <tr>
                <th style="background-color: #EEEEEE; border: none;"></th>
                <th style="background-color: #EEEEEE; border: none;"></th>
                <th style="background-color: #EEEEEE; border: none; border-left: thin; border-left-style: dotted; border-left-color: #FFFFFF; width: 150px;">Status</th>
                <th style="background-color: #EEEEEE; border: none; border-left: thin; border-left-style: dotted; border-left-color: #FFFFFF; width: 150px;">Action</th>
                <th style="background-color: #EEEEEE; border: none; border-left: thin; border-left-style: dotted; border-left-color: #FFFFFF; width: 150px;">Status</th>
                <th style="background-color: #EEEEEE; border: none; border-left: thin; border-left-style: dotted; border-left-color: #FFFFFF; width: 150px;">Action</th>
            </tr>
        </thead>
        <tbody>

        {% for user in pagination %}
            {% for form in forms %}
                {% if user == form.user %}
                    <tr>
                        <td>{{ user.fullname }}</td>
                        <td>{{ user.team }}</td>

                        {% if (form.formCdp != null) %}
                            <td style="border-left: thin; border-left-style: dotted; border-left-color: #DDDDDD;">{{ form.formCdp.cdpStatus }}</td>
                            <td>
                                {% if (form.formCdp.cdpStatus.id == 3) %}
                                    <a href="{{ path('cdp_edit', {'id': form.id}) }}" class="btn btn-primary"><span class="fa fa-edit"></span> Edit</a>
                                    <a href="{{ path('pdf_cdp', {'id': form.id}) }}" class="btn btn-action"><span class="fa fa-download"></span> Export PDF</a>
                                {% elseif (form.formCdp.cdpStatus.id == 4) or (form.formCdp.cdpStatus.id == 5) or (form.formCdp.cdpStatus.id == 6) or (form.formCdp.cdpStatus.id == 7) or (form.formCdp.cdpStatus.id == 8) %}
                                    <a href="{{ path('cdp_view', {'id': form.id}) }}" class="btn btn-primary"><span class="fa fa-angle-double-right"></span> View</a>
                                    <a href="{{ path('pdf_cdp', {'id': form.id}) }}" class="btn btn-action"><span class="fa fa-download"></span> Export PDF</a>
                                {% else %}
                                    <span class="btn btn-primary" disabled="disabled">No action</span>
                                {% endif %}
                            </td>
                        {% else %}
                            <td style="border-left: thin; border-left-style: dotted; border-left-color: #DDDDDD;">Available</td>
                            <td><span class="btn btn-primary" disabled="disabled">No action</span></td>
                        {% endif %}

                        {% if (form.formYe != null) %}
                            <td style="border-left: thin; border-left-style: dotted; border-left-color: #DDDDDD;">{{ form.formYe.yeStatus }}</td>
                            <td>
                                {% if (form.formYe.yeStatus.id == 3) %}
                                    <a href="{{ path('ye_edit', {'id': form.id}) }}" class="btn btn-primary"><span class="fa fa-edit"></span> Edit</a>
                                    <a href="{{ path('pdf_ye', {'id': form.id}) }}" class="btn btn-action"><span class="fa fa-download"></span> Export PDF</a>
                                {% elseif (form.formYe.yeStatus.id == 4) or (form.formYe.yeStatus.id == 5) or (form.formYe.yeStatus.id == 6) or (form.formYe.yeStatus.id == 7) or (form.formYe.yeStatus.id == 8) %}
                                    <a href="{{ path('ye_view', {'id': form.id}) }}" class="btn btn-primary"><span class="fa fa-angle-double-right"></span> View</a>
                                    <a href="{{ path('pdf_ye', {'id': form.id}) }}" class="btn btn-action"><span class="fa fa-download"></span> Export PDF</a>
                                {% else %}
                                    <span class="btn btn-primary" disabled="disabled">No action</span>
                                {% endif %}
                            </td>
                        {% else %}
                            <td style="border-left: thin; border-left-style: dotted; border-left-color: #DDDDDD;">Available</td>
                            <td><span class="btn btn-primary" disabled="disabled">No action</span></td>
                        {% endif %}
                    </tr>
                {% endif %}
            {% endfor %}
        {% endfor %}

        </tbody>
    </table>
    <div class="navigation" style="text-align: center;">
        {{ knp_pagination_render(pagination) }}
    </div>
{% endblock %}
